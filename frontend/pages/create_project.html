<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Create Project</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

	<style>
		/* Background */
		body.page-bg {
			min-height: 100vh;
			background-image: url('https://images.unsplash.com/photo-1522202176988-66273c2fd55f?auto=format&fit=crop&w=1920&q=80');
			background-size: cover;
			background-position: center;
			background-attachment: fixed;
			font-family: "Segoe UI", sans-serif;
			color: #f8f9fa;
		}
		body.page-bg::before {
			content: "";
			position: fixed;
			inset: 0;
			background: linear-gradient(180deg, rgba(0,0,0,0.55), rgba(0,0,0,0.75));
			z-index: -1;
		}

		/* Glass card */
		.glass-card {
			background: rgba(255,255,255,0.08);
			backdrop-filter: blur(8px);
			-webkit-backdrop-filter: blur(8px);
			border: 1px solid rgba(255,255,255,0.15);
			border-radius: 15px;
			box-shadow: 0 10px 30px rgba(0,0,0,0.3);
			padding: 25px;
		}
		.glass-card h3 {
			color: #fff;
			font-weight: bold;
		}

		/* Inputs */
		.form-control, .form-select {
			background: rgba(255,255,255,0.12);
			border: 1px solid rgba(255,255,255,0.2);
			color: #fff;
		}
		.form-control::placeholder {
			color: #ddd;
		}
		.form-control:focus, .form-select:focus {
			background: rgba(255,255,255,0.18);
			border-color: #66afe9;
			box-shadow: 0 0 0 0.2rem rgba(102,175,233,0.3);
		}

		/* Buttons */
		.btn {
			border-radius: 8px;
			font-weight: 500;
			transition: 0.2s;
		}
		.btn-outline-secondary {
			color: #f8f9fa;
			border-color: #f8f9fa;
		}
		.btn-outline-secondary:hover {
			background: #f8f9fa;
			color: #212529;
		}
		.btn-dark {
			background: #212529;
			border: none;
		}
		.btn-dark:hover {
			background: #000;
		}
		.btn-primary {
			background: #0d6efd;
			border: none;
		}
		.btn-primary:hover {
			background: #0b5ed7;
		}
	</style>
</head>
<body class="page-bg">
	<div class="container my-5 glass-card">
		<div class="d-flex justify-content-between align-items-center mb-4">
			<h3>ðŸš€ Create Project</h3>
			<div class="d-flex gap-2">
				<a class="btn btn-outline-secondary" href="/pages/leader_dashboard.html">â¬… Back</a>
				<button class="btn btn-dark" id="logoutBtn">Logout</button>
			</div>
		</div>

		<div class="row g-3">
			<div class="col-md-6">
				<input class="form-control" id="title" placeholder="Project Title">
			</div>
			<div class="col-md-6">
				<input class="form-control" id="description" placeholder="Short Description">
			</div>
			<div class="col-md-3">
				<input class="form-control" id="start_date" type="date">
			</div>
			<div class="col-md-3">
				<input class="form-control" id="end_date" type="date">
			</div>
			<div class="col-md-3">
				<select id="status" class="form-select">
					<option value="active">Active</option>
					<option value="inactive">Inactive</option>
				</select>
			</div>
			<div class="col-md-3">
				<button class="btn btn-primary w-100" id="create">Create</button>
			</div>
		</div>
	</div>

	<script>
	async function guard(){
		const res = await fetch('/api/auth/me', { credentials:'include' });
		if (!res.ok) { window.location.href='/pages/login.html'; return false; }
		const me = await res.json();
		if (me.role !== 'leader' && me.role !== 'admin') { window.location.href='/pages/error.html'; return false; }
		return true;
	}

	document.getElementById('create').onclick = async ()=>{
		const payload = {
			title: title.value,
			description: description.value,
			start_date: start_date.value || null,
			end_date: end_date.value || null,
			status: status.value
		};
		const res = await fetch('/api/projects', {
			method:'POST',
			headers:{'Content-Type':'application/json'},
			credentials:'include',
			body: JSON.stringify(payload)
		});
		if (!res.ok) { alert('Failed to create project'); return; }
		window.location.href = '/pages/leader_dashboard.html';
	};

	document.getElementById('logoutBtn').onclick = async ()=>{
		await fetch('/api/auth/logout', { method:'POST', credentials:'include' });
		window.location.href = '/pages/login.html';
	};

	guard();
	</script>
</body>
</html>
